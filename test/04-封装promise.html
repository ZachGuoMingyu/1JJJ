<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    // 封装promise
    function sendUrl(url, method, data) {
      // 返回promise对象
      return new Promise(function (resolve, reject) {
        // 封装ajax
        $.ajax({
          url: url,
          method: method,
          data: data,
          success(res){
            resolve(res)
          },
          error(err){
            reject(res)
          }
        })
      })
    }

    // 使用封装好的promie发送网络请求
    // // 获取所有栏目数据
    // let categoryData = sendUrl('http://47.106.244.1:8099/manager/category/findAllCategory','get',{})
    // categoryData
    // .then(function (res) {
    //   console.log(res);
    // })
    // .catch(function (err) {
    //   console.log(err);
    // })

    // // 获取所有用户数据
    // let userData = sendUrl('http://47.106.244.1:8099/manager/user/findAllUser','get',{})
    // userData
    // .then(function (res) {
    //   console.log(res);
    // })
    // .catch(function (err) {
    //   console.log(err);
    // })

    // Promise.all([p1, p2]) 同时发送多个请求
    // let categoryData = sendUrl('http://47.106.244.1:8099/manager/category/findAllCategory', 'get', {})
    // let userData = sendUrl('http://47.106.244.1:8099/manager/user/findAllUser', 'get', {})
    // Promise实例,当p1,p2状态都为fulfilled时候，该实例的状态才为fulfilled，此时p1，p2的返回值组成一个数组，传递给该实例的回调函数；只要p1，p2的返回值有一个变为rejected，该实例状态为rejected
    // 同时发送多个请求 如果所有请求全部成功 那么返回所有的请求结果 只要有一个请求失败 那么久返回失败的结果
    // let p3 = Promise.all([categoryData, userData])
    // console.log(p3);

    // Promise.race([p1,p2])  
    // Promise实例,当p1,p2之中有一个实例率先改变状态，该实例的状态就跟着改变。那个率先改变的 Promise 实例的返回值，就传递给该实例的回调函数
    // 看谁跑得快 哪一个promise对象的网络请求快 就返回哪一个
    let categoryData = sendUrl('http://47.106.244.1:8099/manager/category/findAllCategory', 'get', {})
    let userData = sendUrl('http://47.106.244.1:8099/manager/user/findAllUser', 'get', {})
    let p3 = Promise.race([categoryData, userData])
    console.log(p3);

  </script>
</body>
</html>